# Реализация алгоритма триангуляции Делоне
Подробно про выбранный алгоритм триангуляции и свойства триангуляции Делоне написано в [статье на Хабр](https://habr.com/ru/articles/445048/). 

Программа (как и реализация алгоритма) написана мной.

## Сведения о триангуляции Делоне и описание алгоритма

*Триангуляцией Делоне называется такая триангуляция, в которой для любого треугольника верно, что внутри описанной около него окружности не находится точек из исходного множества.*

#### Условие Делоне
*Пусть на множестве точек задана триангуляция. Будем говорить, что некоторое подмножество точек удовлетворяет 
условию Делоне, если триангуляция, ограниченная на это подмножество, является триангуляцией Делоне для него.*

Отсортировываем все точки, на которых надо построить триангуляцию, по одной из их координат.

Выбираем 3 точки (если изначально эти 3 точки не находились на одной прямой, 
иначе выбираем пока не встретится точка, не лежащая на одной прямой с предыдущими, и её тоже выбираем) и считаем, что
на выбранном множестве условие Делоне выполняется. Это будет базис математической индукции.

Далее на каждой итерации мы будем добавлять следующую из списка точку и проверять, что построенное соединение
рёбрами точек не нарушило условие Делоне. Для этого будем пользоваться следующим критерием:

#### Критерий для триангуляции Делоне
*Выполнение условия Делоне для всех точек, образующих четырехугольник в триангуляции, эквивалентно тому, 
что данная триангуляция является триангуляцией Делоне.*

Для проверки выполнения этого критерия выбираем 4-x угольник, включающий в своё построение ту точку (далее 
т. P), которую мы добавили на этой итерации.
Если этот критерий не выполняется, то меняем построение 2-х треугольников, построенных по точкам 4-х угольника и далее
проверяем, что это же условие выполняется для двух 4-х угольников, 
включающих точки изначального 4-х угольника без т. P.

В конце получим, что триангуляция будет содержать все точки, которые передавались на вход.

## Описание программы
Асимптотическая сложность выбранного алгоритма составляет O(N*log(N)) в среднем и O(N^2) в худшем случае.

Перед вызовом функции *triangulate* отсортировываем точки по координатам и удаляем "наложившиеся" точки, т.е. те, 
у которых совпали обе координаты:
```
points: List[Point] = ...
points.sort(key=lambda point: (point.x, point.y))

points_unique = [points[0]]
for i in range(1, len(points)):
    if points[i] != points[i - 1]:
        points_unique.append(points[i])

points = points_unique
```


Вызываем функцию *triangulate*:
```
triangles = triangulate(points)
```
*triangles* является списком кортежей. Каждый кортеж состоит из 3-х индексов точек 
(индексы точек по их расположению в списке points), которые надо соединить для получения треугольника из 
триангуляции.

Далее, воспользовавшись библиотекой Matplotlib, отрисовываем все 3-х угольники из списка *triangles* 
с помощью алгоритма Брезенхэма (алгоритм отображения прямой по 2-м пикселям):
```
vp = np.full((CANVAS_WIDTH, CANVAS_WIDTH, 3), GRAY, dtype='uint8')
for point in points:
    x, y = int(point.x), int(point.y)
    vp[y - 2:y + 3, x - 2:x + 3] = COLOR
for idx1, idx2, idx3 in triangles:
    x1, y1 = int(points[idx1].x), int(points[idx1].y)
    x2, y2 = int(points[idx2].x), int(points[idx2].y)
    x3, y3 = int(points[idx3].x), int(points[idx3].y)
    vp[y1, x1] = COLOR
    vp[y2, x2] = COLOR
    Bresenhams_line_algorithm(vp, (x1, y1), (x2, y2))
    Bresenhams_line_algorithm(vp, (x1, y1), (x3, y3))
    Bresenhams_line_algorithm(vp, (x2, y2), (x3, y3))
plt.axis('off')
plt.imshow(vp)
plt.show()
```

## Применение триангуляции Делоне

**Для моделирования поверхностей**, являющихся однозначными функциями высот от планового положения точки, используют 
такие виды сетей: регулярная (равномерная прямоугольная) и нерегулярная (триангуляционная).

Основным недостатком регулярной сети является громоздкость
представления данных. Реальные объекты для достаточно детального
представления требуют огромного массива данных. Поэтому приходится
выбирать между точностью представления (размером ячейки) и размером
охватываемой территории.

В триангуляционной модели качество аппроксимации поверхности
значительно выше, чем в регулярной. Но при этом существенно возрастает
сложность обрабатывающих алгоритмов.

Из моделирования поверхностей следуют следующие практические применения триангуляции Делоне:
- построение изоклин (линий, на которых одинаковый уклон поверхности) 
- вычисление объёмов земляных работ
- построение зон и линий видимости (по заданному положению наблюдателя
требуется определить, какие участки поверхности ему видны, а какие нет)
- для построения маски по ключевым точкам лица (в распознавании лиц)
